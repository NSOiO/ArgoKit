source 'https://github.com/CocoaPods/Specs.git'

platform :ios, '10.0'


target 'ArgoKitDemo' do
  use_frameworks!:linkage => :static
  use_modular_headers!
  pod 'ArgoKit', :path=>'../'
  pod 'ArgoKitPreview', :path=>'../', :link_style => 'weak'
  pod 'ArgoKitComponent', :path =>'../'
  
#  pod 'ArgoUI/Kit/AnimationCPP', :git => 'https://github.com/mmdongxin/MLN', :branch => 'dev_iOS_dx_temp'
#  pod 'ArgoUI/Kit/AnimationKit', :path => '../../MLN/ArgoUI.podspec'
# :modular_headers => true
#  pod 'ArgoKitBusinessPod', :path => '../ArgoKitBusinessPod'
#  pod 'ArgoKitPreviewPodDemo', :path => '../ArgoKitPreviewPodDemo'
end

target 'ArgoPreview' do
  use_frameworks!:linkage => :static
  use_modular_headers!
  pod 'ArgoKit', :path=>'../'
  pod 'ArgoKitPreview', :path=>'../', :link_style => 'weak'
  pod 'ArgoKitComponent', :path =>'../'
  
#  pod 'ArgoKitBusinessPod', :path => '../ArgoKitBusinessPod'
#  pod 'ArgoKitPreviewPodDemo', :path => '../ArgoKitPreviewPodDemo'
#  pod 'YYCache'
end

#post_integrate do |installer|
#  ap_target = 'ArgoKitPreview'
#  installer.generated_pod_targets.each do |target|
#    if target.name == ap_target
#      pod_dir = target.sandbox.pod_dir(target.name)
#      file_path = "#{pod_dir}/Source/Script/argokit_preview_config.rb"
#      require file_path
#      integrate_argokit_preview installer
#    end
#  end
#end

#dynamic_frameworks = [ 'ArgoKit', 'Yoga', 'ArgoAnimation'] # <- swift libraries names
#
## Make all the other frameworks into static frameworks by overriding the static_framework? function to return true
#pre_install do |installer|
#  installer.pod_targets.each do |target|
#    if dynamic_frameworks.include?(target.name)
#      puts "Overriding the static_framework? method for #{target.name}"
##      def target.static_framework?;
##        true
##      end
#      def target.dynamic_framework?;
#        true
#      end
#    
#      def target.build_type;
##        Pod::BuildType.static_framework
#         Pod::BuildType.dynamic_framework
#      end
#    end
#  end
#end

post_integrate do |installer|
    ap_target = 'ArgoKitPreview'
    main_project = 'ArgoKitDemo'
    main_target = "ArgoKitDemo"
    main_target2 = 'ArgoPreview'
    
    installer.generated_pod_targets.each do |target|
      if target.name == ap_target
        pod_dir = target.sandbox.pod_dir(target.name)
        file_path = "#{pod_dir}/Source/Script/argokit_preview_config.rb"
        require file_path
        integrate_argokit_preview installer, main_project, main_target
        integrate_argokit_preview installer, main_project, main_target2
      end
    end
end
